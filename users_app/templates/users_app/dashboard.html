{% extends "base.html" %} {% load static %} {% load customtags %} {% comment %}
{% endcomment %} {% block content %}
<style>
  style="list-style: none;
  padding-left: 0;
  text-align: center;
</style>

<article style="margin: 0 auto; text-align: center">
  <h1 style="margin: 2rem">Your account - Welcome @{{ user }} !</h1>
  <h2></h2>
  <section class="d-flex justify-content-center">
    <div class="card m-2 p-2 shadow p-3 mb-5 bg-body rounded">
      <a
        class="card-img-top"
        href="https://www.youtube.com/user/MrBean"
        target="_blank"
        style="
          margin: auto;
          width: 150px;
          height: 150px;
          border-radius: 50%;
          overflow: hidden;
        "
      >
        <img src="{{ user_profile.avatar.url }}" />
      </a>

      <div class="card-body">
        <h2>Links to:</h2>
        <lu style="list-style: none; padding-left: 0; text-align: center">
          <li>
            <a href="{% url 'image_app:form-upload-img' %} " target="_blank">
              Add new picture </a
            >- Upload form
          </li>
        </lu>
      </div>
    </div>
    <div class="card m-2 p-2 shadow p-3 mb-5 bg-body rounded">
      <h3>Avidable membership levels:</h3>

      <ul style="list-style: none; padding-left: 0; text-align: center">
        {% for tier in tiers %}
        <li>
          <p>Tier: {{tier}}</p>
          {% if user_profile.tier == tier %}
          <h4 style="margin-top: 1rem">
            <span style="color: darkred">- Your level</span>
          </h4>
          {% if tier == user_profile.tier %}
          <ul>
            <li>Miniatury: {{tier.mini_size}}</li>
            <li>Orginal image link: {{tier.presence_link_to_org_file}}</li>
            <li>
              Generate expiring link:
              {{tier.ability_to_generate_expiring_links}}
            </li>
          </ul>
          {% endif %} {% endif %} {% endfor %}
        </li>
      </ul>

      <ul style="list-style: none; padding-left: 0; text-align: center">
        {% for index, tiers in tiers_with_miniature_sizes %}
        <li>
          <h4 style="margin-top: 1rem">
            Tier {{ index }}. {{ tiers.tier.name }} {% if user in
            tiers.tier_users %}
            <span style="color: darkred">- Your level</span>
          </h4>

          {% if user in tiers.tier_users %}
          <ul style="list-style: none; padding-left: 0; text-align: center">
            {% for miniature_size in tier_info.miniature_sizes %}
            <li>
              Mini Size: {{ miniature_size.width }}x{{ miniature_size.height }}
            </li>
            {% endfor %}
          </ul>

          {% if tier_info.original_img%}
          <p>Orginal image</p>
          {% endif %} {% if tier_info.generate_exp_link%}
          <p>Generate expiring link</p>
          {% endif %} {% endif %}
        </li>
        {% endfor %}
      </ul>
    </div>
  </section>

  <section>
    <h3>Your Gallery:</h3>

    <p>(You have {% total_img user %} images in.)</p>

    {% for index, tier_info in tiers_with_miniature_sizes %} {% if user in
    tier_info.tier_users %}
    <div
      class="d-flex justify-content-center row row-cols-2 row-cols-lg-5 g-2 g-lg-3"
      style="margin: auto"
    >
      {% for img in img_sended_by_user %}
      <div class="col">
        <div class="card shadow p-3 mb-5 bg-body rounded">
          <img
            style="
              margin: auto;
              width: 100px;
              height: 100px;
              border-radius: 50%;
              overflow: hidden;
            "
            class="card-img-top"
            src="{{ img.image_file.url }}"
            alt="Image {{ img.title }} {{ img.short_description }}"
          />
          <h5 class="card-title m-1">{{ img.title }}</h5>
          {% if img.short_description %}
          <p class="card-text">Desc: {{ img.short_description}}</p>
          {% endif %}
          <div class="card-body">
            <ul style="list-style: none; padding-left: 0; text-align: center">
              Available Image thumbnail sizes: {% for miniature_size in
              tier_info.miniature_sizes %}
              <li>
                <a
                  class="btn btn-primary m-1"
                  target="_blank"
                  href="{% url 'image_app:generate-thumbnail' img.id miniature_size.width miniature_size.height %}"
                >
                  {{ miniature_size.width }}x{{ miniature_size.height }}
                </a>
              </li>
              {% endfor %}
            </ul>

            {% if tier_info.original_img%}
            <a
              style="margin: 0.5rem"
              class="btn btn-primary"
              target="_blank"
              href="{{ img.image_file.url }}"
              >Orginal img</a
            >
            {% endif %} {% if tier_info.generate_exp_link%}
            <a
              href="{% url 'image_app:generate-expiring-link' img.id 340 %}"
              class="btn btn-primary"
              target="_blank"
              >Generate exp link!</a
            >
            {% endif %}
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </section>
</article>

{% endblock %}
